\hypertarget{_g_p_s_interface_8c}{}\section{src/\+G\+P\+S\+Interface.c File Reference}
\label{_g_p_s_interface_8c}\index{src/\+G\+P\+S\+Interface.\+c@{src/\+G\+P\+S\+Interface.\+c}}
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include \char`\"{}G\+P\+S\+Interface.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}log\+Interface.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}serial/serial\+Interface.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}G\+P\+S\+Demo/gps\+\_\+demo.\+h\char`\"{}}\\*
Include dependency graph for G\+P\+S\+Interface.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_g_p_s_interface_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{_g_p_s_interface_8c_a2a940fd545a524efc707bf883f5be6a9}{G\+P\+S\+\_\+init} (\hyperlink{struct_g_p_s___actions}{G\+P\+S\+\_\+\+Actions} $\ast$gps\+Handler)
\begin{DoxyCompactList}\small\item\em assignes the correct library for the get\+G\+PS function pointer. either an R\+Pi or a demo implementation of the get\+G\+P\+S\+Sample() will be used. \end{DoxyCompactList}\item 
double \hyperlink{_g_p_s_interface_8c_a6b2e7c4d2b3a08fa15ebb18365a9264c}{to\+\_\+deg} (double x)
\begin{DoxyCompactList}\small\item\em converts N\+M\+EA decimal value to degrees (used for conversion of lat lon values) \end{DoxyCompactList}\item 
\hyperlink{types_8h_af6a258d8f3ee5206d682d799316314b1}{bool} \hyperlink{_g_p_s_interface_8c_ac71865e68cf32819594bdcd0c4244f8d}{geofence\+\_\+breached} (\hyperlink{struct_full_g_p_s_data}{Full\+G\+P\+S\+Data} $\ast$location, \hyperlink{struct_zone__general}{Zone\+\_\+general} $\ast$zone)
\begin{DoxyCompactList}\small\item\em runs tests for different kinds of possible geofence violations, if one of the tests is failed (i.\+e some kind of violation has occured), there\textquotesingle{}s a breach. Winding Number algorithm for test of Point-\/\+In-\/\+Polygon inclusion. see \href{http://geomalgorithms.com/a03-_inclusion.html}{\tt http\+://geomalgorithms.\+com/a03-\/\+\_\+inclusion.\+html} \end{DoxyCompactList}\item 
int \hyperlink{_g_p_s_interface_8c_ac6b4d89308a2b0eab06656a5dd3d5858}{geofecnce\+\_\+alt\+\_\+check} (\hyperlink{struct_zone__general}{Zone\+\_\+general} $\ast$zone, double altitude)
\begin{DoxyCompactList}\small\item\em checks if the altitude in question is within the geofence\textquotesingle{}s height. \end{DoxyCompactList}\item 
int \hyperlink{_g_p_s_interface_8c_a74f9c1235487a3808df665a9bb7334b5}{geofence\+\_\+polygon\+\_\+check} (\hyperlink{struct_zone__general}{Zone\+\_\+general} $\ast$zone, \hyperlink{struct_g_e_o___point}{G\+E\+O\+\_\+\+Point} p)
\begin{DoxyCompactList}\small\item\em checks if the point in question is inside or outside the geofence polygon. uses the Winding-\/\+Number algorithm for test of Point-\/\+In-\/\+Polygon inclusion. see \href{http://geomalgorithms.com/a03-_inclusion.html}{\tt http\+://geomalgorithms.\+com/a03-\/\+\_\+inclusion.\+html} \end{DoxyCompactList}\item 
float \hyperlink{_g_p_s_interface_8c_a22f27d68e1909aff8c3d3f8f19be4d02}{det} (\hyperlink{struct_g_e_o___point}{G\+E\+O\+\_\+\+Point} p1, \hyperlink{struct_g_e_o___point}{G\+E\+O\+\_\+\+Point} p2, \hyperlink{struct_g_e_o___point}{G\+E\+O\+\_\+\+Point} location)
\begin{DoxyCompactList}\small\item\em the signed area of the triangle loc,P1,P2 \end{DoxyCompactList}\item 
int \hyperlink{_g_p_s_interface_8c_aa6cdb7200af7d74a9c583d5c00a50e35}{create\+\_\+edges} (\hyperlink{struct_zone__general}{Zone\+\_\+general} $\ast$zone, \hyperlink{struct_edge}{Edge} $\ast$$\ast$edges)
\begin{DoxyCompactList}\small\item\em Creates the edges of the polygon from its vertices. Called once. \end{DoxyCompactList}\item 
void \hyperlink{_g_p_s_interface_8c_a8e93b5c352c25afd3fa2aa27ae411e3a}{find\+\_\+mbr} (\hyperlink{struct_zone__general}{Zone\+\_\+general} $\ast$polygon)
\begin{DoxyCompactList}\small\item\em computes the minimum bounding rectangle of the polygon. (aka \hyperlink{struct_m_b_r}{M\+BR}) \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}!create\+\_\+edges@{create\+\_\+edges}}
\index{create\+\_\+edges@{create\+\_\+edges}!G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}}
\subsubsection[{\texorpdfstring{create\+\_\+edges(\+Zone\+\_\+general $\ast$zone, Edge $\ast$$\ast$edges)}{create_edges(Zone_general *zone, Edge **edges)}}]{\setlength{\rightskip}{0pt plus 5cm}int create\+\_\+edges (
\begin{DoxyParamCaption}
\item[{{\bf Zone\+\_\+general} $\ast$}]{zone, }
\item[{{\bf Edge} $\ast$$\ast$}]{edges}
\end{DoxyParamCaption}
)}\hypertarget{_g_p_s_interface_8c_aa6cdb7200af7d74a9c583d5c00a50e35}{}\label{_g_p_s_interface_8c_aa6cdb7200af7d74a9c583d5c00a50e35}


Creates the edges of the polygon from its vertices. Called once. 


\begin{DoxyParams}{Parameters}
{\em zone} & The polygon -\/ represented by its vertices \\
\hline
{\em edges} & A \hyperlink{struct_edge}{Edge} pointer. points to an array of edges that is populated in this function \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
returns the number of edges. (Actually returns the number of vertices). 
\end{DoxyReturn}
\index{G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}!det@{det}}
\index{det@{det}!G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}}
\subsubsection[{\texorpdfstring{det(\+G\+E\+O\+\_\+\+Point p1, G\+E\+O\+\_\+\+Point p2, G\+E\+O\+\_\+\+Point location)}{det(GEO_Point p1, GEO_Point p2, GEO_Point location)}}]{\setlength{\rightskip}{0pt plus 5cm}float det (
\begin{DoxyParamCaption}
\item[{{\bf G\+E\+O\+\_\+\+Point}}]{p1, }
\item[{{\bf G\+E\+O\+\_\+\+Point}}]{p2, }
\item[{{\bf G\+E\+O\+\_\+\+Point}}]{location}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{_g_p_s_interface_8c_a22f27d68e1909aff8c3d3f8f19be4d02}{}\label{_g_p_s_interface_8c_a22f27d68e1909aff8c3d3f8f19be4d02}


the signed area of the triangle loc,P1,P2 

T\+O\+DO\+: inline ? 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em p1} & Polygon\textquotesingle{}s first point \\
\hline
\mbox{\tt in}  & {\em p2} & Polygon\textquotesingle{}s second point \\
\hline
 & {\em location} & The query point\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the determinant 
\end{DoxyReturn}
\index{G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}!find\+\_\+mbr@{find\+\_\+mbr}}
\index{find\+\_\+mbr@{find\+\_\+mbr}!G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}}
\subsubsection[{\texorpdfstring{find\+\_\+mbr(\+Zone\+\_\+general $\ast$polygon)}{find_mbr(Zone_general *polygon)}}]{\setlength{\rightskip}{0pt plus 5cm}void find\+\_\+mbr (
\begin{DoxyParamCaption}
\item[{{\bf Zone\+\_\+general} $\ast$}]{polygon}
\end{DoxyParamCaption}
)}\hypertarget{_g_p_s_interface_8c_a8e93b5c352c25afd3fa2aa27ae411e3a}{}\label{_g_p_s_interface_8c_a8e93b5c352c25afd3fa2aa27ae411e3a}


computes the minimum bounding rectangle of the polygon. (aka \hyperlink{struct_m_b_r}{M\+BR}) 


\begin{DoxyParams}{Parameters}
{\em polygon} & a struct with the polygon\textquotesingle{}s points. \\
\hline
\end{DoxyParams}
\index{G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}!geofecnce\+\_\+alt\+\_\+check@{geofecnce\+\_\+alt\+\_\+check}}
\index{geofecnce\+\_\+alt\+\_\+check@{geofecnce\+\_\+alt\+\_\+check}!G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}}
\subsubsection[{\texorpdfstring{geofecnce\+\_\+alt\+\_\+check(\+Zone\+\_\+general $\ast$zone, double altitude)}{geofecnce_alt_check(Zone_general *zone, double altitude)}}]{\setlength{\rightskip}{0pt plus 5cm}int geofecnce\+\_\+alt\+\_\+check (
\begin{DoxyParamCaption}
\item[{{\bf Zone\+\_\+general} $\ast$}]{zone, }
\item[{double}]{altitude}
\end{DoxyParamCaption}
)}\hypertarget{_g_p_s_interface_8c_ac6b4d89308a2b0eab06656a5dd3d5858}{}\label{_g_p_s_interface_8c_ac6b4d89308a2b0eab06656a5dd3d5858}


checks if the altitude in question is within the geofence\textquotesingle{}s height. 

T\+O\+DO\+: min and max alt. 
\begin{DoxyParams}[1]{Parameters}
 & {\em zone} & The Polygon. the \hyperlink{struct_zone__general}{Zone\+\_\+general} struct contains the limit altitude \\
\hline
\mbox{\tt in}  & {\em altitude} & The altitude of the point in question.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
one of the constants describing the status, according to the outcome of the height test. 
\end{DoxyReturn}
\index{G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}!geofence\+\_\+breached@{geofence\+\_\+breached}}
\index{geofence\+\_\+breached@{geofence\+\_\+breached}!G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}}
\subsubsection[{\texorpdfstring{geofence\+\_\+breached(\+Full\+G\+P\+S\+Data $\ast$location, Zone\+\_\+general $\ast$zone)}{geofence_breached(FullGPSData *location, Zone_general *zone)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf bool} geofence\+\_\+breached (
\begin{DoxyParamCaption}
\item[{{\bf Full\+G\+P\+S\+Data} $\ast$}]{location, }
\item[{{\bf Zone\+\_\+general} $\ast$}]{zone}
\end{DoxyParamCaption}
)}\hypertarget{_g_p_s_interface_8c_ac71865e68cf32819594bdcd0c4244f8d}{}\label{_g_p_s_interface_8c_ac71865e68cf32819594bdcd0c4244f8d}


runs tests for different kinds of possible geofence violations, if one of the tests is failed (i.\+e some kind of violation has occured), there\textquotesingle{}s a breach. Winding Number algorithm for test of Point-\/\+In-\/\+Polygon inclusion. see \href{http://geomalgorithms.com/a03-_inclusion.html}{\tt http\+://geomalgorithms.\+com/a03-\/\+\_\+inclusion.\+html} 


\begin{DoxyParams}{Parameters}
{\em location} & the location of the test points (coordinates) \\
\hline
{\em zone} & the Polygon -\/ represented by its vertices \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
returns true if the point is inside the polygon. if the point is inside the polygon, the winding number is non-\/zero. a detailed description of the algorithm is in the link. 
\end{DoxyReturn}
T\+O\+DO\+: differentiate between W\+GS and M\+SL. T\+O\+DO\+: check for minimum altitude ?\index{G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}!geofence\+\_\+polygon\+\_\+check@{geofence\+\_\+polygon\+\_\+check}}
\index{geofence\+\_\+polygon\+\_\+check@{geofence\+\_\+polygon\+\_\+check}!G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}}
\subsubsection[{\texorpdfstring{geofence\+\_\+polygon\+\_\+check(\+Zone\+\_\+general $\ast$zone, G\+E\+O\+\_\+\+Point p)}{geofence_polygon_check(Zone_general *zone, GEO_Point p)}}]{\setlength{\rightskip}{0pt plus 5cm}int geofence\+\_\+polygon\+\_\+check (
\begin{DoxyParamCaption}
\item[{{\bf Zone\+\_\+general} $\ast$}]{zone, }
\item[{{\bf G\+E\+O\+\_\+\+Point}}]{p}
\end{DoxyParamCaption}
)}\hypertarget{_g_p_s_interface_8c_a74f9c1235487a3808df665a9bb7334b5}{}\label{_g_p_s_interface_8c_a74f9c1235487a3808df665a9bb7334b5}


checks if the point in question is inside or outside the geofence polygon. uses the Winding-\/\+Number algorithm for test of Point-\/\+In-\/\+Polygon inclusion. see \href{http://geomalgorithms.com/a03-_inclusion.html}{\tt http\+://geomalgorithms.\+com/a03-\/\+\_\+inclusion.\+html} 


\begin{DoxyParams}[1]{Parameters}
 & {\em zone} & The geofence polygon \\
\hline
\mbox{\tt in}  & {\em p} & the P\+OI \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
one of the constants describing the status, according to the outcome of the PiP test. 
\end{DoxyReturn}
\index{G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}!G\+P\+S\+\_\+init@{G\+P\+S\+\_\+init}}
\index{G\+P\+S\+\_\+init@{G\+P\+S\+\_\+init}!G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}}
\subsubsection[{\texorpdfstring{G\+P\+S\+\_\+init(\+G\+P\+S\+\_\+\+Actions $\ast$gps\+Handler)}{GPS_init(GPS_Actions *gpsHandler)}}]{\setlength{\rightskip}{0pt plus 5cm}int G\+P\+S\+\_\+init (
\begin{DoxyParamCaption}
\item[{{\bf G\+P\+S\+\_\+\+Actions} $\ast$}]{gps\+Handler}
\end{DoxyParamCaption}
)}\hypertarget{_g_p_s_interface_8c_a2a940fd545a524efc707bf883f5be6a9}{}\label{_g_p_s_interface_8c_a2a940fd545a524efc707bf883f5be6a9}


assignes the correct library for the get\+G\+PS function pointer. either an R\+Pi or a demo implementation of the get\+G\+P\+S\+Sample() will be used. 

\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\index{G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}!to\+\_\+deg@{to\+\_\+deg}}
\index{to\+\_\+deg@{to\+\_\+deg}!G\+P\+S\+Interface.\+c@{G\+P\+S\+Interface.\+c}}
\subsubsection[{\texorpdfstring{to\+\_\+deg(double x)}{to_deg(double x)}}]{\setlength{\rightskip}{0pt plus 5cm}double to\+\_\+deg (
\begin{DoxyParamCaption}
\item[{double}]{x}
\end{DoxyParamCaption}
)}\hypertarget{_g_p_s_interface_8c_a6b2e7c4d2b3a08fa15ebb18365a9264c}{}\label{_g_p_s_interface_8c_a6b2e7c4d2b3a08fa15ebb18365a9264c}


converts N\+M\+EA decimal value to degrees (used for conversion of lat lon values) 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em x} & the decimal value extracted as-\/is from N\+M\+EA \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a value converted from dec to deg 
\end{DoxyReturn}
